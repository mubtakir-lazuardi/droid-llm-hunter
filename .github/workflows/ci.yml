name: CI Pipeline

on:
  push:
    branches: ["master", "main"]
  pull_request:

jobs:
  build-and-verify:
    name: Build & Sanity Check
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Build Docker Image
        run: docker build -t droid-llm-hunter:test .

      - name: Verify Container Startup (Health Check)
        # Runs the container with --help to ensure:
        # 1. Python environment is correct
        # 2. Dependencies are loaded
        # 3. Entrypoint logic works (dlh.py is accessible)
        run: docker run --rm droid-llm-hunter:test --help

      - name: Verify Entrypoint Script Syntax
        # Ensures our shell script has no syntax errors before packaging
        run: bash -n scripts/ci/entrypoint.sh
