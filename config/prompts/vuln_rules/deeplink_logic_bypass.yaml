name: "Deep Link Logic Bypass"
description: "Detects logic flaws in Deep Link handling, such as IDOR, Authentication Bypass, and Open Redirects."
prompt: |
  Analyze the following Java/Smali code for Deep Link Logic Flaws.
  
  Vulnerability Pattern:
  - Code handles URI parameters using `getQueryParameter("token")`, `("url")`, `("redirect")`, `("next")`.
  - Weak validation logic, e.g., `url.startsWith("http")` (can be bypassed with `http.evil.com`).
  - Usage of sensitive parameters (auth tokens, user IDs) directly from the Deep Link without session verification.
  - Open Redirects: `intent.setData(Uri.parse(param))` or `webview.loadUrl(param)` without host validation.
  
  Code to Analyze:
  ```java
  {code_snippet}
  ```
  
  Context:
  - File Path: {file_path}
  
  Identify if:
  1. The code extracts sensitive params or URL targets from the Intent URI.
  2. The validation is missing OR weak (e.g. simple `startsWith`, `contains`).
  
  If yes, report VULNERABLE and describe the bypass method (e.g., "Attacker can supply malicious URL via 'redirect' parameter").
keywords:
  - "getQueryParameter"
  - "getData"
  - "startsWith"
  - "loadUrl"
  - "redirect"
  - "token"
tags: ["deeplink", "idor", "open_redirect", "logic_flaw"]
detection_pattern: "(?i)(\\.(getQueryParameter|getData)|Uri\\.parse|scheme|host)"
